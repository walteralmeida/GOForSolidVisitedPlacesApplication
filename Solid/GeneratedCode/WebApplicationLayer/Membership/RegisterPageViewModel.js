////////////////////////////////////////////////////////////////////////////////////////////
// This is Generated Code
// You should not modify this code as it may be overwritten. Use Partial classes instead
// Generated By Generative Objects  
////////////////////////////////////////////////////////////////////////////////////////////
 
(function () {
    // 
    Solid.Web.Membership.RegisterPageViewModel = function () {
        var self = this;

        this.securityProviderProxy = new Solid.Web.Model.Components.GOSecurityProviderProxy(this.ObjectsDataSet);

        this.data = {
			username: ko.observable(null),
			email: ko.observable(null),
            password: ko.observable(null),
			registerFailed: ko.observable(false),
            errorMessage: ko.observable(null),
			loginLink: ko.observable("./Login.html"),
			lostPasswordLink: ko.observable("./LostPassword.html"),
        };

        this.commands = {
            register: function () {
                self.register();
            },
			registerText: ko.observable(Solid.Web.Messages.register),
			registerEnabled: ko.observable(true)
        };

        this.register = function () {
             $(':input').trigger('change');
			var configuration = {};
			configuration.username = self.data.username();
			configuration.email = self.data.email();
            configuration.password = self.data.password();
            configuration.successHandler = self.onRegisterSucceeded;
            configuration.errorHandler = self.onRegisterError;
		
			self.commands.registerText(Solid.Web.Messages.registering);
			self.commands.registerEnabled("false");

			self.securityProviderProxy.Register(configuration);
		};

        this.onRegisterSucceeded = function (token) {
			window.location = Solid.Web.Application.BaseURL 
				+ window.location.hash
				;
		};

        this.onRegisterError = function (error) {
			self.commands.registerText(Solid.Web.Messages.register);
			self.commands.registerEnabled("true");
			self.data.username(null);
			self.data.email(null);
	        self.data.password(null);    
			self.data.registerFailed(true);
	        self.data.errorMessage(error);
        };

        // Apply bindings
        ko.applyBindings(self, $("#Main").get(0));
    };
}());